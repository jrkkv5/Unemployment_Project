---
title: "Jeff"
author: "https://github.com/jrkkv5/FIN6572Fall2020/blob/master/National%20Debt/importNationalDebt.Rmd"
date: "11/8/2020"
output: html_document
---

``` {r load_necessary_packages}
library(readr)
library(devtools)
library(blsAPI)
library(rjson)
library(curl)
library(dplyr)
library(tidyverse)
#Loads necessary packages

merged_final <- read_csv("csv files/mergedFinal.csv")
#Reads final file into merged dataframe

merged_final$log_pop = log(merged_final$population)

merged_final$log_RMHI = log(merged_final$RMHI)

#My states: CA, TX, NY, FL, PA, IL, OH
```


``` {r CA Basic Analysis}

CA_observations <- merged_final[ merged_final$state == "CA", ]
CA_base <- CA_observations[ CA_observations$year < 2014, ] # Creates training set for model
CA_sampleset <-  CA_observations[ CA_observations$year > 2013, ] # Creates set to test model

scatter.smooth(CA_base$year, CA_base$value, main="Unemployment by Year", xlab = "Year", ylab = "Unemployment", col = "blue")

scatter.smooth(CA_base$year, CA_base$HPI, main="HPI by Year", xlab = "Year", ylab = "HPI", col = "blue")

scatter.smooth(x=CA_base$year, y=CA_base$value, main="Unemployment by Year", xlab = "Year", ylab = "Unemployment", col = "red")

scatter.smooth(x=CA_base$year, y=CA_base$poverty, main="% of People Below Poverty Level", xlab = "Year", ylab = "Poverty", ylim = c(0,20))

CA_base$RMHI <- as.integer(CA_base$RMHI)
plot(x=CA_base$year, y=CA_base$RMHI, main="Median Household Income by Year", xlab = "Year", ylab = "RMHI" )

CA_base$population <- as.integer(CA_base$population)
plot(x=CA_base$year, y=CA_base$population, main="Population by Year", xlab = "Year", ylab = "Population" )


cor(CA_base$RMHI, CA_base$value)
cor(CA_base$HPI, CA_base$value)
cor(CA_base$poverty, CA_base$value)
cor(CA_base$population, CA_base$value)
cor(CA_base$sp500, CA_base$value)
#run base correlations between categories and dependent variable

par(mfrow=c(1, 2))  # divide graph area in 2 columns
boxplot(CA_base$value, main="Unemployment", sub=paste("Outlier rows: ", boxplot.stats(CA_base$value)$out))  # box plot for 'Unemployment'
boxplot(CA_base$poverty, main="Poverty", sub=paste("Outlier rows: ", boxplot.stats(CA_base$poverty)$out))  # box plot for 'Poverty'
#create box plot for poverty level and unemployment level


CA_Test <- lm(value ~ poverty + RMHI + HPI + population + sp500, data = CA_base)
summary(CA_Test)
anova(CA_Test)
#run multiple linear model for data

CA_linearModelSignificant <- lm(value ~ poverty + population, data = CA_base)
summary(CA_linearModelSignificant)
#test to show a scatterplot CA HPI data against year

CA_linearModel <- lm(value ~ poverty + RMHI + HPI + log(population) + sp500, data = CA_base)
summary(CA_linearModel)
anova(CA_linearModel)
```

``` {r TX Basic Analysis}

TX_base <- merged_final[ merged_final$state == "TX", ]

scatter.smooth(TX_base$year, TX_base$value, main="Unemployment by Year", xlab = "Year", ylab = "Unemployment", col = "blue", span = 2/3)

scatter.smooth(TX_base$year, TX_base$HPI, main="HPI by Year", xlab = "Year", ylab = "HPI", col = "blue")

scatter.smooth(x=TX_base$year, y=TX_base$value, main="Unemployment by Year", xlab = "Year", ylab = "Unemployment", col = "red")

scatter.smooth(x=TX_base$year, y=TX_base$poverty, main="% of People Below Poverty Level", xlab = "Year", ylab = "Poverty", ylim = c(0,20))

TX_base$RMHI <- as.integer(TX_base$RMHI)
plot(x=TX_base$year, y=TX_base$RMHI, main="Median Household Income by Year", xlab = "Year", ylab = "RMHI" )

TX_base$population <- as.integer(TX_base$population)
plot(x=TX_base$year, y=TX_base$population, main="Population by Year", xlab = "Year", ylab = "Population" )

```
``` {r NY Basic Analysis}

NY_base <- merged_final[ merged_final$state == "NY", ]

scatter.smooth(NY_base$year, NY_base$value, main="Unemployment by Year", xlab = "Year", ylab = "Unemployment", col = "blue")

scatter.smooth(NY_base$year, NY_base$HPI, main="HPI by Year", xlab = "Year", ylab = "HPI", col = "blue")

scatter.smooth(x=NY_base$year, y=NY_base$value, main="Unemployment by Year", xlab = "Year", ylab = "Unemployment", col = "red")

scatter.smooth(x=NY_base$year, y=NY_base$poverty, main="% of People Below Poverty Level", xlab = "Year", ylab = "Poverty", ylim = c(0,20))

NY_base$RMHI <- as.integer(NY_base$RMHI)
plot(x=NY_base$year, y=NY_base$RMHI, main="Median Household Income by Year", xlab = "Year", ylab = "RMHI" )

NY_base$population <- as.integer(NY_base$population)
plot(x=NY_base$year, y=NY_base$population, main="Population by Year", xlab = "Year", ylab = "Population" )

```

``` {r FL Basic Analysis}

FL_base <- merged_final[ merged_final$state == "FL", ]

scatter.smooth(FL_base$year, FL_base$value, main="Unemployment by Year", xlab = "Year", ylab = "Unemployment", col = "blue")

scatter.smooth(FL_base$year, FL_base$HPI, main="HPI by Year", xlab = "Year", ylab = "HPI", col = "blue")

scatter.smooth(x=FL_base$year, y=FL_base$value, main="Unemployment by Year", xlab = "Year", ylab = "Unemployment", col = "red")

scatter.smooth(x=FL_base$year, y=FL_base$poverty, main="% of People Below Poverty Level", xlab = "Year", ylab = "Poverty", ylim = c(0,20))

FL_base$RMHI <- as.integer(FL_base$RMHI)
plot(x=FL_base$year, y=FL_base$RMHI, main="Median Household Income by Year", xlab = "Year", ylab = "RMHI" )

FL_base$population <- as.integer(FL_base$population)
plot(x=FL_base$year, y=FL_base$population, main="Population by Year", xlab = "Year", ylab = "Population" )

```


``` {r PA Basic Analysis}

PA_base <- merged_final[ merged_final$state == "PA", ]

scatter.smooth(PA_base$year, PA_base$value, main="Unemployment by Year", xlab = "Year", ylab = "Unemployment", col = "blue")

scatter.smooth(PA_base$year, PA_base$HPI, main="HPI by Year", xlab = "Year", ylab = "HPI", col = "blue")

scatter.smooth(x=PA_base$year, y=PA_base$value, main="Unemployment by Year", xlab = "Year", ylab = "Unemployment", col = "red")

scatter.smooth(x=PA_base$year, y=PA_base$poverty, main="% of People Below Poverty Level", xlab = "Year", ylab = "Poverty", ylim = c(0,20))

PA_base$RMHI <- as.integer(PA_base$RMHI)
plot(x=PA_base$year, y=PA_base$RMHI, main="Median Household Income by Year", xlab = "Year", ylab = "RMHI" )

PA_base$population <- as.integer(PA_base$population)
plot(x=PA_base$year, y=PA_base$population, main="Population by Year", xlab = "Year", ylab = "Population" )

```

``` {r IL Basic Analysis}

IL_base <- merged_final[ merged_final$state == "IL", ]

scatter.smooth(IL_base$year, IL_base$value, main="Unemployment by Year", xlab = "Year", ylab = "Unemployment", col = "blue")

scatter.smooth(IL_base$year, IL_base$HPI, main="HPI by Year", xlab = "Year", ylab = "HPI", col = "blue")

scatter.smooth(x=IL_base$year, y=IL_base$value, main="Unemployment by Year", xlab = "Year", ylab = "Unemployment", col = "red")

scatter.smooth(x=IL_base$year, y=IL_base$poverty, main="% of People Below Poverty Level", xlab = "Year", ylab = "Poverty", ylim = c(0,20))

IL_base$RMHI <- as.integer(IL_base$RMHI)
plot(x=IL_base$year, y=IL_base$RMHI, main="Median Household Income by Year", xlab = "Year", ylab = "RMHI" )

IL_base$population <- as.integer(IL_base$population)
plot(x=IL_base$year, y=IL_base$population, main="Population by Year", xlab = "Year", ylab = "Population" )

```

``` {r OH Basic Analysis}

OH_base <- merged_final[ merged_final$state == "OH", ]

scatter.smooth(OH_base$year, OH_base$value, main="Unemployment by Year", xlab = "Year", ylab = "Unemployment", col = "blue")

scatter.smooth(OH_base$year, OH_base$HPI, main="HPI by Year", xlab = "Year", ylab = "HPI", col = "blue")

scatter.smooth(x=OH_base$year, y=OH_base$value, main="Unemployment by Year", xlab = "Year", ylab = "Unemployment", col = "red")

scatter.smooth(x=OH_base$year, y=OH_base$poverty, main="% of People Below Poverty Level", xlab = "Year", ylab = "Poverty", ylim = c(0,20))

OH_base$RMHI <- as.integer(OH_base$RMHI)
plot(x=OH_base$year, y=OH_base$RMHI, main="Median Household Income by Year", xlab = "Year", ylab = "RMHI" )

OH_base$population <- as.integer(OH_base$population)
plot(x=OH_base$year, y=OH_base$population, main="Population by Year", xlab = "Year", ylab = "Population" )

```